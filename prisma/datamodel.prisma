type Event {
  id: ID! @id
  createdAt: DateTime! @createdAt
  apiVersion: String
  kind: String
  level: String!
  auditID: ID @unique
  stage: String!
  requestURI: String!
  verb: String!
  user: UserInfo! @relation(link: INLINE)
  sourceIPs: [String!] @scalarList(strategy: RELATION)
  userAgent: String 
  responseStatus: ResponseStatus @relation(link: INLINE)
  requestObject: ObjectReference @relation(link: INLINE)
  requestReceivedTimestamp: String
  stageTimestamp: String
  annotations: Json
}

type ResponseStatus {
  id: ID! @id
  createdAt: DateTime! @createdAt
  metadata: Json
  status: String
  reason: String
  code: Int
  event: Event!
}

type UserInfo {
  id: ID! @id
  createdAt: DateTime! @createdAt
  username: String!
  groups: [String!]! @scalarList(strategy: RELATION)
  event: Event!
}

type ObjectReference{
  id: ID! @id
  createdAt: DateTime! @createdAt
  resource: String
  namespace: String
  name: String
  uid: ID @unique
  apiGroup: String
  apiVersion: String
  resourceVersion: String
  subresource: String
  event: Event!
}
