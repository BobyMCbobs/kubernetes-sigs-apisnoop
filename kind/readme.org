#+TITLE: kind + apisnoop
* Setup
#+begin_src shell
  git clone https://github.com/cncf/apisnoop
  cd apisnoop/kind
  kind create cluster --config=kind+apisnoop.yaml
#+end_src
* Logs
Not necessary, but may help in debugging.
** Snoop DB
#+begin_src shell
kubectl logs apisnoop-kind-control-plane snoopdb -f
#+end_src
** Auditlogger
#+begin_src shell
kubectl logs apisnoop-kind-control-plane auditlogger -f
#+end_src
* Database
** Variables for psql
#+begin_src shell
  export PGUSER=apisnoop
  export PGHOST=localhost
#+end_src
** sql
#+begin_src sql-mode
\dt+
#+end_src

#+RESULTS:
#+begin_SRC example
                                              List of relations
 Schema |    Name     | Type  |  Owner   |  Size   |                       Description
--------+-------------+-------+----------+---------+----------------------------------------------------------
 public | audit_event | table | apisnoop | 878 MB  | every event from an e2e test run, or multiple test runs.
 public | open_api    | table | apisnoop | 5080 kB | endpoint details from openAPI spec
(2 rows)

#+end_SRC

#+begin_src sql
\d+
#+end_src

#+RESULTS:
#+begin_SRC example
List of relations
Schema	Name	Type	Owner	Size	Description
public	audit_event	table	apisnoop	878 MB	every event from an e2e test run, or multiple test runs.
public	audit_event_id_seq	sequence	apisnoop	8192 bytes
public	audit_event_test	view	apisnoop	0 bytes	every test in the audit_log of a release
public	endpoint_coverage	view	apisnoop	0 bytes	Coverage info for every endpoint in a release, taken from audit events for that release
public	open_api	table	apisnoop	5080 kB	endpoint details from openAPI spec
#+end_SRC
